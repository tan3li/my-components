{"version":3,"file":"calendar.js","sourceRoot":"","sources":["../../../../src/components/inputs/calendar/calendar.tsx"],"names":[],"mappings":"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","sourcesContent":["import {CalendarGrid, CalendarGridProps} from './calendargrid.js';\nimport {AriaCalendarProps, DateValue, useCalendar} from 'react-aria';\nimport {useLocales} from '../../../contexts/index.js';\nimport {classNames} from '../../../utils/classnames.js';\nimport {Button, ButtonStyle, ButtonVariant, IconButton} from '../../action/index.js';\nimport {useTranslateDatePeriod} from '../../../hooks/translations/usetranslatedateperiod.js';\nimport {iconNames} from '../../media/index.js';\nimport {Size} from '../../../constants/index.js';\nimport {useCalendarState} from 'react-stately';\nimport {CalendarDate, createCalendar, today} from '@internationalized/date';\nimport {useTranslateCommon} from '../../../hooks/translations/usetranslatecommon.js';\nimport {ReactNode, RefAttributes, useEffect, useMemo, useState} from 'react';\nimport {Select, SelectItem} from '../select/index.js';\nimport {Divider} from '../../datadisplay/index.js';\nimport {safeCall} from '../../../utils/functionhelper.js';\nimport {useLanguageDay} from '../../../hooks/uselanguageday.js';\nimport {CalendarContext, useContextProps} from 'react-aria-components';\nimport {getDateValue} from './getdatevalue.js';\nimport {SkeletonCalendar} from '../../feedback/skeleton/skeletoncalendar.js';\n\nexport interface CalendarProps\n    extends Omit<\n            AriaCalendarProps<DateValue>,\n            'onChange' | 'value' | 'defaultValue' | 'focusedValue' | 'defaultFocusedValue' | 'minValue' | 'maxValue'\n        >,\n        RefAttributes<HTMLDivElement> {\n    /**\n     * CSS class name for the element.\n     */\n    className?: string;\n    /**\n     * Provide footer to render custom content below the calendar grid.\n     */\n    footer?: ReactNode;\n    /**\n     * Whether week of selected date should be highlighted.\n     */\n    highlightSelectedWeek?: boolean;\n    /**\n     * Whether to show skeleton instead of an actual element.\n     */\n    isSkeleton?: boolean;\n    /**\n     * Maximum date user can select. Can be provided as ISO 8601 date string (YYYY-MM-DD) or DateValue object.\n     */\n    maxValue?: DateValue | string;\n    /**\n     * Minimum date user can select. Can be provided as ISO 8601 date string (YYYY-MM-DD) or DateValue object.\n     */\n    minValue?: DateValue | string;\n    /**\n     * Selected date change callback.\n     */\n    onChange?: (date: DateValue) => void;\n    /**\n     * Date related to selected value which will create a range between them.\n     */\n    relatedValue?: DateValue | string | null;\n    /**\n     * Custom cell content renderer.\n     */\n    renderCellContent?: CalendarGridProps['renderCellContent'];\n    /**\n     * Whether to show week numbers.\n     */\n    showWeekNumbers?: boolean;\n    /**\n     * Selected date for the calendar. Can be provided as ISO 8601 date string (YYYY-MM-DD) or DateValue object.\n     */\n    value?: DateValue | string | null;\n    /**\n     * Range for year select items. By default, year select shows current year +/- 5 years.\n     */\n    yearSelectionRange?: {\n        start: number;\n        end: number;\n    };\n}\n\nconst PAST_YEAR_ITEM_COUNT = 5;\nconst FUTURE_YEAR_ITEM_COUNT = 5;\n\nfunction isInvalidDate(date: DateValue, minValue?: DateValue | null, maxValue?: DateValue | null) {\n    return !!(minValue && date.compare(minValue) < 0) || !!(maxValue && date.compare(maxValue) > 0);\n}\n\nexport function Calendar({\n    className,\n    footer,\n    highlightSelectedWeek,\n    isSkeleton,\n    maxValue: propsMaxValue,\n    minValue: propsMinValue,\n    onFocusChange: propsOnFocusChange,\n    ref,\n    relatedValue,\n    renderCellContent,\n    showWeekNumbers = true,\n    yearSelectionRange,\n    ...props\n}: CalendarProps) {\n    const {isDisabled, isReadOnly} = props;\n    const {cultureLocale, languageLocale, timeZone} = useLocales();\n    const languageDay = useLanguageDay();\n    const translateDatePeriod = useTranslateDatePeriod();\n    const translateCommon = useTranslateCommon();\n    const [contextProps, refObj] = useContextProps(\n        {\n            ...props,\n            maxValue: getDateValue(propsMaxValue) ?? undefined,\n            minValue: getDateValue(propsMinValue) ?? undefined\n        },\n        ref ?? null,\n        CalendarContext\n    );\n    const {onChange, minValue, maxValue, value} = contextProps;\n    const [selectedDate, setSelectedDate] = useState<DateValue | null>(getDateValue(value));\n    const [focusedDate, setFocusedDate] = useState(selectedDate ?? today(timeZone));\n\n    const onFocusChange = (date: CalendarDate) => {\n        if (date.compare(focusedDate) !== 0) {\n            setFocusedDate(date);\n            propsOnFocusChange?.(date);\n        }\n    };\n\n    const derivedProps: AriaCalendarProps<DateValue> = {\n        ...contextProps,\n        focusedValue: focusedDate,\n        isDateUnavailable: (date) =>\n            isInvalidDate(date, minValue, maxValue) || !!contextProps.isDateUnavailable?.(date),\n        maxValue: undefined,\n        minValue: undefined,\n        onChange: (date) => {\n            setSelectedDate(date);\n            safeCall(onChange, date);\n        },\n        onFocusChange,\n        value: selectedDate\n    };\n\n    const state = useCalendarState({\n        ...derivedProps,\n        locale: cultureLocale,\n        createCalendar\n    });\n    const {calendarProps, prevButtonProps, nextButtonProps} = useCalendar(derivedProps, state);\n\n    const monthItems: Array<SelectItem<number>> = useMemo(\n        () =>\n            languageDay()\n                .localeData()\n                .months()\n                .map((month, i) => ({value: i + 1, text: month})),\n        [languageLocale]\n    );\n    const yearItems: Array<SelectItem<number>> = useMemo(() => {\n        let startYear: number, endYear: number;\n\n        if (yearSelectionRange) {\n            startYear = yearSelectionRange.start;\n            endYear = yearSelectionRange.end;\n        } else {\n            const currentYear = today(timeZone).year;\n\n            startYear = currentYear - PAST_YEAR_ITEM_COUNT;\n            endYear = currentYear + FUTURE_YEAR_ITEM_COUNT;\n        }\n\n        const arr: Array<SelectItem<number>> = [];\n\n        for (let year = startYear; year <= endYear; year++) {\n            arr.push({value: year, text: year.toString()});\n        }\n\n        return arr;\n    }, [timeZone, yearSelectionRange?.start, yearSelectionRange?.end]);\n\n    useEffect(() => {\n        setSelectedDate(getDateValue(value));\n    }, [value]);\n\n    if (isSkeleton) {\n        return <SkeletonCalendar />;\n    }\n\n    return (\n        <div {...calendarProps} className={classNames('calendar', className)} ref={refObj}>\n            <div className=\"calendar-header\">\n                <div className=\"calendar-header__start\">\n                    <IconButton\n                        {...prevButtonProps}\n                        aria-label={translateDatePeriod('previousMonth')}\n                        iconName={iconNames.ChevronLeft}\n                        size={Size.md}\n                        style={ButtonStyle.Plain}\n                        variant={ButtonVariant.Neutral}\n                    />\n                    <IconButton\n                        {...nextButtonProps}\n                        aria-label={translateDatePeriod('nextMonth')}\n                        iconName={iconNames.ChevronRight}\n                        size={Size.md}\n                        style={ButtonStyle.Plain}\n                        variant={ButtonVariant.Neutral}\n                    />\n                    <Select\n                        aria-label={translateDatePeriod('month')}\n                        isDisabled={isDisabled}\n                        isPlain={true}\n                        isReadOnly={isReadOnly}\n                        isSearchable={false}\n                        items={monthItems}\n                        menuWidth=\"150px\"\n                        onSelectionChange={(month) => {\n                            onFocusChange(new CalendarDate(focusedDate.year, month!, focusedDate.day));\n                        }}\n                        size={Size.xs}\n                        text={monthItems[focusedDate.month - 1].text}\n                        value={focusedDate.month}\n                    />\n                    <Select\n                        aria-label={translateDatePeriod('year')}\n                        isDisabled={isDisabled}\n                        isPlain={true}\n                        isReadOnly={isReadOnly}\n                        isSearchable={false}\n                        items={yearItems}\n                        menuWidth=\"100px\"\n                        onSelectionChange={(year) => {\n                            onFocusChange(new CalendarDate(year!, focusedDate.month, focusedDate.day));\n                        }}\n                        size={Size.xs}\n                        text={focusedDate.year.toString()}\n                        value={focusedDate.year}\n                    />\n                </div>\n                <div className=\"calendar-header__end\">\n                    <Button\n                        isDisabled={!!isDisabled || !!isReadOnly}\n                        onPress={() => {\n                            onFocusChange(today(timeZone));\n                        }}\n                        size={Size.md}\n                        style={ButtonStyle.Plain}\n                        variant={ButtonVariant.Neutral}>\n                        {translateCommon('today')}\n                    </Button>\n                </div>\n            </div>\n            <Divider size={Size.sm} />\n            <CalendarGrid\n                highlightSelectedWeek={highlightSelectedWeek}\n                relatedValue={relatedValue}\n                renderCellContent={renderCellContent}\n                showWeekNumbers={showWeekNumbers}\n                state={state}\n            />\n            {footer && (\n                <>\n                    <Divider size={Size.sm} />\n                    <div className=\"calendar-footer\">{footer}</div>\n                </>\n            )}\n        </div>\n    );\n}\n"]}